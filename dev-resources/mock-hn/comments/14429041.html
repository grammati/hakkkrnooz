<html op="item"><head><meta name="referrer" content="origin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="news.css?gR6Qb2lTHRpCq5mLHBib">
        <link rel="shortcut icon" href="favicon.ico">
        <title>Security of BIOS&#x2F;UEFI System Firmware from Attacker and Defender Perspectives | Hacker News</title></head><body><center><table id="hnmain" border="0" cellpadding="0" cellspacing="0" width="85%" bgcolor="#f6f6ef">
        <tr><td bgcolor="#ff6600"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="padding:2px"><tr><td style="width:18px;padding-right:4px"><a href="http://www.ycombinator.com"><img src="y18.gif" width="18" height="18" style="border:1px white solid;"></a></td>
                  <td style="line-height:12pt; height:10px;"><span class="pagetop"><b class="hnname"><a href="news">Hacker News</a></b>
              <a href="newest">new</a> | <a href="newcomments">comments</a> | <a href="show">show</a> | <a href="ask">ask</a> | <a href="jobs">jobs</a> | <a href="submit">submit</a>            </span></td><td style="text-align:right;padding-right:4px;"><span class="pagetop">
                              <a href="login?goto=item%3Fid%3D14429041">login</a>
                          </span></td>
              </tr></table></td></tr>
<tr style="height:10px"></tr><tr><td><table border="0">
        <tr class='athing' id='14429041'>
      <td align="right" valign="top" class="title"><span class="rank"></span></td>      <td valign="top" class="votelinks"><center><a id='up_14429041' href='vote?id=14429041&amp;how=up&amp;goto=item%3Fid%3D14429041'><div class='votearrow' title='upvote'></div></a></center></td><td class="title"><a href="https://github.com/advanced-threat-research/firmware-security-training" class="storylink">Security of BIOS/UEFI System Firmware from Attacker and Defender Perspectives</a><span class="sitebit comhead"> (<a href="from?site=github.com"><span class="sitestr">github.com</span></a>)</span></td></tr><tr><td colspan="2"></td><td class="subtext">
        <span class="score" id="score_14429041">45 points</span> by <a href="user?id=adulau" class="hnuser">adulau</a> <span class="age"><a href="item?id=14429041">12 hours ago</a></span> <span id="unv_14429041"></span> | <a href="hide?id=14429041&amp;goto=item%3Fid%3D14429041">hide</a> | <a href="https://hn.algolia.com/?query=Security%20of%20BIOS%2FUEFI%20System%20Firmware%20from%20Attacker%20and%20Defender%20Perspectives&sort=byDate&dateRange=all&type=story&storyText=false&prefix&page=0" class="hnpast">past</a> | <a href="https://www.google.com/search?q=Security%20of%20BIOS%2FUEFI%20System%20Firmware%20from%20Attacker%20and%20Defender%20Perspectives">web</a> | <a href="item?id=14429041">3&nbsp;comments</a> | <a href="fave?id=14429041&amp;auth=ccc6815d7d48607157c235abffdac5bee05f3760">favorite</a>              </td></tr>
            <tr style="height:10px"></tr><tr><td colspan="2"></td><td>
          <form method="post" action="comment"><input type="hidden" name="parent" value="14429041"><input type="hidden" name="goto" value="item?id=14429041"><input type="hidden" name="hmac" value="69fc9e0ff90b3777fdd15ba62dd9c3815264c018"><textarea name="text" rows="6" cols="60"></textarea>
                <br><br><input type="submit" value="add comment"></form>
      </td></tr>
  </table><br><br>
  <table border="0" class='comment-tree'>
            <tr class='athing comtr ' id='14430572'><td>
            <table border='0'>  <tr>    <td class='ind'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks"><center><a id='up_14430572' href='vote?id=14430572&amp;how=up&amp;goto=item%3Fid%3D14429041'><div class='votearrow' title='upvote'></div></a></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=oneplane" class="hnuser">oneplane</a> <span class="age"><a href="item?id=14430572">1 hour ago</a></span> <span id="unv_14430572"></span><span class="par"></span> <a class="togg" n="2" href="javascript:void(0)" onclick="return toggle(event, 14430572)"></a>          <span class='storyon'></span>
                  </span></div><br><div class="comment">
                  <span class="c00">An this is why I&#x27;m trying very hard to get coreboot to work on my systems, and I&#x27;m very eager to see Libreboot-type of FSP&#x2F;BSP-free images in the future so we can actually verify our boot chain.<p>Keeping all of the firmware code secret makes no sense, and seems to be artificially enforced by &#x27;patents&#x27;, and &#x27;trade secrets&#x27; while most likely the vendors are trying to keep buggy code secret and hope that obscurity alone will keep them safe.<span>
              </span><div class='reply'>        <p><font size="1">
                      <u><a href="reply?id=14430572&amp;goto=item%3Fid%3D14429041%2314430572">reply</a></u>
                  </font>
      </div></td></tr>
      </table></td></tr>
        <tr class='athing comtr ' id='14430926'><td>
            <table border='0'>  <tr>    <td class='ind'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks"><center><a id='up_14430926' href='vote?id=14430926&amp;how=up&amp;goto=item%3Fid%3D14429041'><div class='votearrow' title='upvote'></div></a></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=minipci1321" class="hnuser">minipci1321</a> <span class="age"><a href="item?id=14430926">27 minutes ago</a></span> <span id="unv_14430926"></span><span class="par"></span> <a class="togg" n="1" href="javascript:void(0)" onclick="return toggle(event, 14430926)"></a>          <span class='storyon'></span>
                  </span></div><br><div class="comment">
                  <span class="c00">In my opinion, vendors are oblivious to the notion of the buggy code. From the releasing-a-product standpoint, there is a tested or an untested code. While personally I wouldn&#x27;t be surprised that someone could knowingly release firmware containing known &quot;stability issues&quot;, I doubt any vendor hides source code out of fear that someone else will discover some hypothetical bugs. Among other problems, finding bugs in an unknown firmawre is not so simple, as it requires an intimate knowledge of the underlying hardware (and a fair share of the bugs is closely related to its quirks), which might be not so familiar as, say, well-established (and relatively well-documented) Intel Architecture.<span>
              </span><div class='reply'>        <p><font size="1">
                      <u><a href="reply?id=14430926&amp;goto=item%3Fid%3D14429041%2314430926">reply</a></u>
                  </font>
      </div></td></tr>
      </table></td></tr>
                <tr class='athing comtr ' id='14429439'><td>
            <table border='0'>  <tr>    <td class='ind'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks"><center><a id='up_14429439' href='vote?id=14429439&amp;how=up&amp;goto=item%3Fid%3D14429041'><div class='votearrow' title='upvote'></div></a></center></td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=zkms" class="hnuser">zkms</a> <span class="age"><a href="item?id=14429439">8 hours ago</a></span> <span id="unv_14429439"></span><span class="par"></span> <a class="togg" n="1" href="javascript:void(0)" onclick="return toggle(event, 14429439)"></a>          <span class='storyon'></span>
                  </span></div><br><div class="comment">
                  <span class="c00">Seeing slides in BIOS-UEFI-Security.6-Mitigations.pdf that imply that there&#x27;s critical crypto being done in SMM mode makes me feel unfathomable hopelessness. The whole x86_64 platform security model (which includes all the privilege levels and the corresponding access control mechanisms) is one hell of an overgrown clusterfuck that could not be <i>more</i> hostile to formal verification.<p>There&#x27;s lots of wantonly convoluted stuff going on -- a random example is the access control mechanism for the PCH&#x27;s GPIOs (search &quot;GPIO registers lockdown&quot;, in quotes). This isn&#x27;t, of course, implemented with a register which contains bitfields determining which privilege level can write to which sets of registers. That would be too simple. The GPIO Lockdown-Enable bit <i>can</i> [sic] be changed by the same software that the lockdown mechanism is meant to deny access to! This seems like utter pointlessness -- what use is an access control mechanism if the agent being restricted can change the parameters of the mechanism willy-nilly -- but Intel has a solution! Changing the lockdown-enable bit triggers an SMI and shunts control to SMM mode, which is, naturally, expected to include code that figures out that this bit should not be disabled, and is to flip it back on (and return from the interrupt, having trashed the caches a bit).<p>This is, of course, a pathologically needless level of complexity -- in the ARM world, we have registers with silly names like &quot;NSACR&quot; that higher-privileged execution modes can set to restrict access to certain resources. There&#x27;s certainly no BIOS-OEM-provided code that needs to exist and be correct in order to implement such a basic task. In the end, this level of access-control is equivalent to a bloody Boolean operation or two, for heaven&#x27;s sake! All the CPU needs to do is to decode the instruction, realise it&#x27;s a potentially-privileged instruction, decode what the instruction tries to modify, look up in a table which register holds the relevant permissions bitfield, and do the relevant boolean operation between that register&#x27;s contents and an appropriate bitmask, and fault depending on the result. Since there&#x27;s an extremely close match between the properties that needs to hold (the truth table of all combinations of &quot;privilege level <i>x</i> can modify resource <i>y</i> iff bit <i>n</i> in register <i>z</i> is set&quot;) and the mechanism that enforces it, it&#x27;s easy to reason about this scheme and not difficult to either prove an implementation correct (or find counterexamples).<p>Meanwhile, the &quot;wake up SMM and hope it&#x27;ll countermands the illegal write&quot; scheme depends on a lot more machinery. How does it work on a multi-core&#x2F;multi-socket platform? How does this mechanism interact with the caches or the memory model? Is it possible to set up a race condition where the illegal write ends up going through uncountermanded because SMM mode can be made to not see the register in an illegal state? This is orders of magnitude of orders of magnitude more complex than analysing a lookup-table and a bitmask -- we need to understand the semantics of memory reads&#x2F;writes, of caching, of mode switches to SMM and the SMI interrupt, and how all of this clusterfuck is affected by the fact that there&#x27;s <i>multiple cores</i> in our system. LANGSEC people will call this a &quot;shotgun parser&quot; -- when input data checking &#x2F; recognition is interspersed with processing logic.<p>Even if all of this miraculously works and there&#x27;s literally no way that all the cores working together can send an illegal write that SMM code won&#x27;t countermand -- there&#x27;s still the issue of making sure that the specific SMM blob that our BIOS OEM wrote cooperates properly with this. Indeed, making BIOS OEMs implement these sorts of convoluted and critical mechanisms and expecting them to get all of them perfectly right requires a level of optimism that doesn&#x27;t yet exist. The situation has devolved to the point that there is literally a tool called &quot;chipsec&quot; that lets you test for the presence of a handful of well-known security-critical things (from time to time someone discovers a new one, of course, UEFI&#x2F;ACPI and the x86_64 privilege model is too complex for people to be sure that we found all the issues) that UEFI programmers are <i>notorious</i> for messing up. That this tool needs to exist is shameful. Of course, the security of the x86_64 platform doesn&#x27;t just depend on a bunch of magic access control registers being set right, there&#x27;s Turing-complete code that needs to be implemented by the BIOS OEM (and runs in the most privileged execution mode that isn&#x27;t Intel&#x27;s &quot;management processor&quot;) that is <i>security-critical</i>, and, well, it&#x27;s hard to prove that arbitrary Turing-complete code behaves correctly.<p>The auxiliary CPU mode (SMM) initially meant to hide APM and emulate PS&#x2F;2 mice in 90s-era computers is now <i>critical</i> to platform security, and does dangerous stuff like crypto and handling pointers from UEFI &#x2F; the OS. Every few months someone I follow on Twitter finds some new way to trick some widely-deployed SMM code into writing to a memory region it shouldn&#x27;t, it&#x27;s quite depressing. Great. Another pointless defender&#x2F;attacker arms race that the defenders could decisively win had Intel thrown away the spitefully complex intricacies of SMM and the x86 security model and replaced it with a clean, formal-verification-friendly set of privilege levels whose correct operation doesn&#x27;t depend on platform firmware code. Even AArch64 is less broken when it comes to this.<span>
              </span><div class='reply'>        <p><font size="1">
                      <u><a href="reply?id=14429439&amp;goto=item%3Fid%3D14429041%2314429439">reply</a></u>
                  </font>
      </div></td></tr>
      </table></td></tr>
            </table>
      <br><br>
  </td></tr>
<tr><td><img src="s.gif" height="10" width="0"><table width="100%" cellspacing="0" cellpadding="1"><tr><td bgcolor="#ff6600"></td></tr></table><br><center><span class="yclinks"><a href="newsguidelines.html">Guidelines</a>
        | <a href="newsfaq.html">FAQ</a>
        | <a href="mailto:hn@ycombinator.com">Support</a>
        | <a href="https://github.com/HackerNews/API">API</a>
        | <a href="security.html">Security</a>
        | <a href="lists">Lists</a>
        | <a href="bookmarklet.html">Bookmarklet</a>
        | <a href="dmca.html">DMCA</a>
        | <a href="http://www.ycombinator.com/apply/">Apply to YC</a>
        | <a href="mailto:hn@ycombinator.com">Contact</a></span><br><br><form method="get" action="//hn.algolia.com/">Search:
          <input type="text" name="q" value="" size="17" autocorrect="off" spellcheck="false" autocapitalize="off" autocomplete="false"></form>
            </center></td></tr>      </table></center></body><script type='text/javascript' src='hn.js?gR6Qb2lTHRpCq5mLHBib'></script></html>
